RESET MASTER;
SET SESSION wsrep_on=OFF;
RESET MASTER;
SET SESSION wsrep_on=ON;
SET SESSION wsrep_on=OFF;
RESET MASTER;
SET SESSION wsrep_on=ON;
START SLAVE USER='root';
Warnings:
Note	1759	Sending passwords in plain text without SSL/TLS is extremely insecure.
CREATE SCHEMA test1;
CREATE SCHEMA test2;
USE test1;
CREATE TABLE t1 (f1 INTEGER PRIMARY KEY,f2 CHAR(5) DEFAULT 'abc') ENGINE=InnoDB;
USE test2;
CREATE TABLE t1 (f1 INTEGER PRIMARY KEY,f2 CHAR(5) DEFAULT 'abc') ENGINE=InnoDB;
INSERT INTO test1.t1 (f1) VALUES (1);
INSERT INTO test2.t1 (f1) VALUES (1);
INSERT INTO test1.t1 (f1) VALUES (2);
INSERT INTO test2.t1 (f1) VALUES (2);
INSERT INTO test1.t1 (f1) VALUES (3);
INSERT INTO test2.t1 (f1) VALUES (3);
UPDATE test2.t1 SET test2.t1.f2 = 'cde';
UPDATE test1.t1, test2.t1 SET test1.t1.f2 = 'klm', test2.t1.f2 = 'xyz';
DELETE test1.t1, test2.t1 FROM test1.t1 INNER JOIN test2.t1 WHERE test1.t1.f1 = test2.t1.f1 AND test1.t1.f1 = 3;
SET AUTOCOMMIT=OFF;
START TRANSACTION;
INSERT INTO test2.t1 (f1) VALUES (999);
INSERT INTO test2.t1 (f1) VALUES (9999);
COMMIT;
START TRANSACTION;
INSERT INTO test1.t1 (f1) VALUES (111);
INSERT INTO test1.t1 (f1) VALUES (222);
COMMIT;
START TRANSACTION;
INSERT INTO test1.t1 (f1) VALUES (333);
INSERT INTO test2.t1 (f1) VALUES (99999);
COMMIT;
SHOW BINLOG EVENTS IN 'mysqld-bin.000001' FROM 124;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
mysqld-bin.000001	124	Previous_gtids	2	155	
mysqld-bin.000001	155	Gtid	1	235	SET @@SESSION.GTID_NEXT= '<effective_uuid>:1'
mysqld-bin.000001	235	Query	1	342	CREATE SCHEMA test1 /* xid=### */
mysqld-bin.000001	342	Gtid	1	422	SET @@SESSION.GTID_NEXT= '<effective_uuid>:2'
mysqld-bin.000001	422	Query	1	498	BEGIN
mysqld-bin.000001	498	Query	1	575	COMMIT
mysqld-bin.000001	575	Gtid	1	655	SET @@SESSION.GTID_NEXT= '<effective_uuid>:3'
mysqld-bin.000001	655	Query	1	822	use `test1`; CREATE TABLE t1 (f1 INTEGER PRIMARY KEY,f2 CHAR(5) DEFAULT 'abc') ENGINE=InnoDB /* xid=### */
mysqld-bin.000001	822	Gtid	1	902	SET @@SESSION.GTID_NEXT= '<effective_uuid>:4'
mysqld-bin.000001	902	Query	1	978	BEGIN
mysqld-bin.000001	978	Query	1	1055	COMMIT
mysqld-bin.000001	1055	Gtid	1	1137	SET @@SESSION.GTID_NEXT= '<effective_uuid>:5'
mysqld-bin.000001	1137	Query	1	1208	BEGIN
mysqld-bin.000001	1208	Table_map	1	1265	table_id: ### (test1.t1)
mysqld-bin.000001	1265	Write_rows	1	1309	table_id: ### flags: STMT_END_F
mysqld-bin.000001	1309	Xid	1	1340	COMMIT /* xid=### */
mysqld-bin.000001	1340	Gtid	1	1420	SET @@SESSION.GTID_NEXT= '<effective_uuid>:6'
mysqld-bin.000001	1420	Query	1	1486	BEGIN
mysqld-bin.000001	1486	Query	1	1553	COMMIT
mysqld-bin.000001	1553	Gtid	1	1635	SET @@SESSION.GTID_NEXT= '<effective_uuid>:7'
mysqld-bin.000001	1635	Query	1	1706	BEGIN
mysqld-bin.000001	1706	Table_map	1	1763	table_id: ### (test1.t1)
mysqld-bin.000001	1763	Write_rows	1	1807	table_id: ### flags: STMT_END_F
mysqld-bin.000001	1807	Xid	1	1838	COMMIT /* xid=### */
mysqld-bin.000001	1838	Gtid	1	1918	SET @@SESSION.GTID_NEXT= '<effective_uuid>:8'
mysqld-bin.000001	1918	Query	1	1984	BEGIN
mysqld-bin.000001	1984	Query	1	2051	COMMIT
mysqld-bin.000001	2051	Gtid	1	2133	SET @@SESSION.GTID_NEXT= '<effective_uuid>:9'
mysqld-bin.000001	2133	Query	1	2204	BEGIN
mysqld-bin.000001	2204	Table_map	1	2261	table_id: ### (test1.t1)
mysqld-bin.000001	2261	Write_rows	1	2305	table_id: ### flags: STMT_END_F
mysqld-bin.000001	2305	Xid	1	2336	COMMIT /* xid=### */
mysqld-bin.000001	2336	Gtid	1	2416	SET @@SESSION.GTID_NEXT= '<effective_uuid>:10'
mysqld-bin.000001	2416	Query	1	2482	BEGIN
mysqld-bin.000001	2482	Query	1	2549	COMMIT
mysqld-bin.000001	2549	Gtid	1	2629	SET @@SESSION.GTID_NEXT= '<effective_uuid>:11'
mysqld-bin.000001	2629	Query	1	2695	BEGIN
mysqld-bin.000001	2695	Query	1	2762	COMMIT
mysqld-bin.000001	2762	Gtid	1	2844	SET @@SESSION.GTID_NEXT= '<effective_uuid>:12'
mysqld-bin.000001	2844	Query	1	2915	BEGIN
mysqld-bin.000001	2915	Table_map	1	2972	table_id: ### (test1.t1)
mysqld-bin.000001	2972	Update_rows	1	3062	table_id: ### flags: STMT_END_F
mysqld-bin.000001	3062	Xid	1	3093	COMMIT /* xid=### */
mysqld-bin.000001	3093	Gtid	1	3175	SET @@SESSION.GTID_NEXT= '<effective_uuid>:13'
mysqld-bin.000001	3175	Query	1	3246	BEGIN
mysqld-bin.000001	3246	Table_map	1	3303	table_id: ### (test1.t1)
mysqld-bin.000001	3303	Delete_rows	1	3347	table_id: ### flags: STMT_END_F
mysqld-bin.000001	3347	Xid	1	3378	COMMIT /* xid=### */
mysqld-bin.000001	3378	Gtid	1	3458	SET @@SESSION.GTID_NEXT= '<effective_uuid>:14'
mysqld-bin.000001	3458	Query	1	3524	BEGIN
mysqld-bin.000001	3524	Query	1	3591	COMMIT
mysqld-bin.000001	3591	Gtid	1	3673	SET @@SESSION.GTID_NEXT= '<effective_uuid>:15'
mysqld-bin.000001	3673	Query	1	3744	BEGIN
mysqld-bin.000001	3744	Table_map	1	3801	table_id: ### (test1.t1)
mysqld-bin.000001	3801	Write_rows	1	3845	table_id: ### flags: STMT_END_F
mysqld-bin.000001	3845	Table_map	1	3902	table_id: ### (test1.t1)
mysqld-bin.000001	3902	Write_rows	1	3946	table_id: ### flags: STMT_END_F
mysqld-bin.000001	3946	Xid	1	3977	COMMIT /* xid=### */
mysqld-bin.000001	3977	Gtid	1	4059	SET @@SESSION.GTID_NEXT= '<effective_uuid>:16'
mysqld-bin.000001	4059	Query	1	4130	BEGIN
mysqld-bin.000001	4130	Table_map	1	4187	table_id: ### (test1.t1)
mysqld-bin.000001	4187	Write_rows	1	4231	table_id: ### flags: STMT_END_F
mysqld-bin.000001	4231	Xid	1	4262	COMMIT /* xid=### */
gtid_executed_equal
1
SHOW BINLOG EVENTS IN 'mysqld-bin.000001' FROM 124;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
mysqld-bin.000001	124	Previous_gtids	3	155	
mysqld-bin.000001	155	Gtid	1	235	SET @@SESSION.GTID_NEXT= '<effective_uuid>:1'
mysqld-bin.000001	235	Query	1	342	CREATE SCHEMA test1 /* xid=### */
mysqld-bin.000001	342	Gtid	1	422	SET @@SESSION.GTID_NEXT= '<effective_uuid>:2'
mysqld-bin.000001	422	Query	1	498	BEGIN
mysqld-bin.000001	498	Query	1	575	COMMIT
mysqld-bin.000001	575	Gtid	1	655	SET @@SESSION.GTID_NEXT= '<effective_uuid>:3'
mysqld-bin.000001	655	Query	1	822	use `test1`; CREATE TABLE t1 (f1 INTEGER PRIMARY KEY,f2 CHAR(5) DEFAULT 'abc') ENGINE=InnoDB /* xid=### */
mysqld-bin.000001	822	Gtid	1	902	SET @@SESSION.GTID_NEXT= '<effective_uuid>:4'
mysqld-bin.000001	902	Query	1	978	BEGIN
mysqld-bin.000001	978	Query	1	1055	COMMIT
mysqld-bin.000001	1055	Gtid	1	1137	SET @@SESSION.GTID_NEXT= '<effective_uuid>:5'
mysqld-bin.000001	1137	Query	1	1208	BEGIN
mysqld-bin.000001	1208	Table_map	1	1265	table_id: ### (test1.t1)
mysqld-bin.000001	1265	Write_rows	1	1309	table_id: ### flags: STMT_END_F
mysqld-bin.000001	1309	Xid	1	1340	COMMIT /* xid=### */
mysqld-bin.000001	1340	Gtid	1	1420	SET @@SESSION.GTID_NEXT= '<effective_uuid>:6'
mysqld-bin.000001	1420	Query	1	1486	BEGIN
mysqld-bin.000001	1486	Query	1	1553	COMMIT
mysqld-bin.000001	1553	Gtid	1	1635	SET @@SESSION.GTID_NEXT= '<effective_uuid>:7'
mysqld-bin.000001	1635	Query	1	1706	BEGIN
mysqld-bin.000001	1706	Table_map	1	1763	table_id: ### (test1.t1)
mysqld-bin.000001	1763	Write_rows	1	1807	table_id: ### flags: STMT_END_F
mysqld-bin.000001	1807	Xid	1	1838	COMMIT /* xid=### */
mysqld-bin.000001	1838	Gtid	1	1918	SET @@SESSION.GTID_NEXT= '<effective_uuid>:8'
mysqld-bin.000001	1918	Query	1	1984	BEGIN
mysqld-bin.000001	1984	Query	1	2051	COMMIT
mysqld-bin.000001	2051	Gtid	1	2133	SET @@SESSION.GTID_NEXT= '<effective_uuid>:9'
mysqld-bin.000001	2133	Query	1	2204	BEGIN
mysqld-bin.000001	2204	Table_map	1	2261	table_id: ### (test1.t1)
mysqld-bin.000001	2261	Write_rows	1	2305	table_id: ### flags: STMT_END_F
mysqld-bin.000001	2305	Xid	1	2336	COMMIT /* xid=### */
mysqld-bin.000001	2336	Gtid	1	2416	SET @@SESSION.GTID_NEXT= '<effective_uuid>:10'
mysqld-bin.000001	2416	Query	1	2482	BEGIN
mysqld-bin.000001	2482	Query	1	2549	COMMIT
mysqld-bin.000001	2549	Gtid	1	2629	SET @@SESSION.GTID_NEXT= '<effective_uuid>:11'
mysqld-bin.000001	2629	Query	1	2695	BEGIN
mysqld-bin.000001	2695	Query	1	2762	COMMIT
mysqld-bin.000001	2762	Gtid	1	2844	SET @@SESSION.GTID_NEXT= '<effective_uuid>:12'
mysqld-bin.000001	2844	Query	1	2915	BEGIN
mysqld-bin.000001	2915	Table_map	1	2972	table_id: ### (test1.t1)
mysqld-bin.000001	2972	Update_rows	1	3062	table_id: ### flags: STMT_END_F
mysqld-bin.000001	3062	Xid	1	3093	COMMIT /* xid=### */
mysqld-bin.000001	3093	Gtid	1	3175	SET @@SESSION.GTID_NEXT= '<effective_uuid>:13'
mysqld-bin.000001	3175	Query	1	3246	BEGIN
mysqld-bin.000001	3246	Table_map	1	3303	table_id: ### (test1.t1)
mysqld-bin.000001	3303	Delete_rows	1	3347	table_id: ### flags: STMT_END_F
mysqld-bin.000001	3347	Xid	1	3378	COMMIT /* xid=### */
mysqld-bin.000001	3378	Gtid	1	3458	SET @@SESSION.GTID_NEXT= '<effective_uuid>:14'
mysqld-bin.000001	3458	Query	1	3524	BEGIN
mysqld-bin.000001	3524	Query	1	3591	COMMIT
mysqld-bin.000001	3591	Gtid	1	3673	SET @@SESSION.GTID_NEXT= '<effective_uuid>:15'
mysqld-bin.000001	3673	Query	1	3744	BEGIN
mysqld-bin.000001	3744	Table_map	1	3801	table_id: ### (test1.t1)
mysqld-bin.000001	3801	Write_rows	1	3845	table_id: ### flags: STMT_END_F
mysqld-bin.000001	3845	Table_map	1	3902	table_id: ### (test1.t1)
mysqld-bin.000001	3902	Write_rows	1	3946	table_id: ### flags: STMT_END_F
mysqld-bin.000001	3946	Xid	1	3977	COMMIT /* xid=### */
mysqld-bin.000001	3977	Gtid	1	4059	SET @@SESSION.GTID_NEXT= '<effective_uuid>:16'
mysqld-bin.000001	4059	Query	1	4130	BEGIN
mysqld-bin.000001	4130	Table_map	1	4187	table_id: ### (test1.t1)
mysqld-bin.000001	4187	Write_rows	1	4231	table_id: ### flags: STMT_END_F
mysqld-bin.000001	4231	Xid	1	4262	COMMIT /* xid=### */
include/diff_servers.inc [servers=2 3]
SELECT COUNT(*) = 2 FROM test1.t1 WHERE f1 IN (1,2);
COUNT(*) = 2
1
SELECT COUNT(*) = 3 FROM test1.t1 WHERE f1 IN (111,222,333);
COUNT(*) = 3
1
SELECT COUNT(*) = 2 FROM test1.t1 WHERE f2 = 'klm';
COUNT(*) = 2
1
USE test2;
ERROR 42000: Unknown database 'test2'
DROP SCHEMA test1;
DROP SCHEMA test2;
STOP SLAVE;
RESET SLAVE ALL;
